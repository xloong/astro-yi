---
title: 暴风影音II 0day漏洞曝光
description: 今日监测到一个高度危险暴风影音II漏洞被曝光，该漏洞发生在暴风影音II的一个activex控件上，当安装了暴风影音II的用户在浏览黑客精心构造的包含恶意代码的网页后，会下载任意程序在用户系统上以当前用户上下文权限运行。同时我们在国内发现已有漏洞利用生成器开始流传，并在最近的挂马网站监测中发现有网站利用暴风影音II漏洞进行挂马。 　　影响版本：暴风影音II 　　漏洞的原因如下：　　暴风影音包含一个sparser.dll文件，此dll的一个导出函数在处理非法超长URL时发生栈溢出。黑客可以构造一个网页调用activex控件中的rawParse函数，通过rawParse调用sparser.dll中存在问题的导出函数，从而导致溢出，执行任意代码。
date: 2007-09-11 00:42:44
category: 漏洞信息
tags: ['暴风影音', '0day', 'exploit']
post_id: 159
alias: 159
ViewNums: 4610
---

前2天发了一篇关于[暴风影音隐藏文件](/blog/146a)的文章，这几天幻影旅团上又研究起了它的一个溢出漏洞，把大概情况发给大家看看：

今日监测到一个高度危险暴风影音II漏洞被曝光，该漏洞发生在暴风影音II的一个activex控件上，当安装了暴风影音II的用户在浏览黑客 精心构造的包含恶意代码的网页后，会下载任意程序在用户系统上以当前用户上下文权限运行。同时我们在国内发现已有漏洞利用生成器开始流传，并在最近的挂马网站监测中发现有网站利用暴风影音II漏洞进行挂马。

　　影响版本：暴风影音II

　　漏洞的原因如下：
　　暴风影音包含一个sparser.dll文件，此dll的一个导出函数在处理非法超长URL时发生栈溢出。黑客可以构造一个网页调用activex控 件中的rawParse函数，通过rawParse调用sparser.dll中存在问题的导出函数，从而导致溢出，执行任意代码。

构造的漏洞利用网页截图：
![](http://dswlab.com/vir/img/baofeng.jpg)

二、解决方案
　　 在暴风影音官方发布补丁之前不要使用暴风影音，或者使用临时解决方案，将下面内容保存为.reg文件，双击导入注册表：
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－Windows Registry Editor Version 5.00
[HKEY_LOCAL_MACHINESOFTWAREMicrosoftInternet ExplorerActiveX Compatibility{6BE52E1D-E586-474F-A6E2-1A85A9B4D9FB}]
"Compatibility Flags"=dword:00000400
－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－

注：本文部分内容参考www.ph4nt0m.org的[《暴风影音2 mps.dll组件多个缓冲区溢出漏洞》](http://pstgroup.blogspot.com/2007/09/advisory2-mpsdll.html)。
