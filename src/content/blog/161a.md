---
title: ARP病毒解决办法
description: 　　ARP病毒病毒发作时候的特征为，中毒的机器会伪造某台电脑的MAC地址，如该伪造地址为网关服务器的地址，那么对整个网络均会造成影响，用户表现为上网经常瞬断。...................
date: 2007-09-12 19:51:25
category: 技术文章
tags: ['ARP', '病毒Virus', '安全']
post_id: 161
alias: 161
ViewNums: 4648
---

ARP病毒病毒发作时候的特征为，中毒的机器会伪造某台电脑的MAC地址，如该伪造地址为网关服务器的地址，那么对整个网络均会造成影响，用户表现为上网经常瞬断。

例子中的IP地址均为假设

一、在任意客户机上进入命令提示符(或MS-DOS方式)，用arp &ndash;a命令查看：

| C:WINNTsystem32>arp -a            　　Interface: 192.168.100.93 on Interface 0x1000003            　　Internet Address Physical Address Type            　　192.168.100.1 00-50-da-8a-62-2c dynamic            　　192.168.100.23 00-11-2f-43-81-8b dynamic            　　192.168.100.24 00-50-da-8a-62-2c dynamic            　　192.168.100.25 00-05-5d-ff-a8-87 dynamic            　　192.168.100.200 00-50-ba-fa-59-fe dynamic |
| --- |

可以看到有两个机器的MAC地址相同，那么实际检查结果为 00-50-da-8a-62-2c为192.168.0.24的MAC地址，192.168.100.1的实际MAC地址为00-02-ba-0b-04-32，我们可以判定192.168.100.24实际上为有病毒的机器，它伪造了192.168.100.1的MAC地址。

二、在192.168.100.24上进入命令提示符(或MS-DOS方式)，用arp &ndash;a命令查看：

| C:WINNTsystem32>arp -a            　　Interface: 192.168.100.24 on Interface 0x1000003            　　Internet Address Physical Address Type            　　192.168.100.1 00-02-ba-0b-04-32 dynamic            　　192.168.100.23 00-11-2f-43-81-8b dynamic            　　192.168.100.25 00-05-5d-ff-a8-87 dynamic            　　192.168.100.193 00-11-2f-b2-9d-17 dynamic            　　192.168.100.200 00-50-ba-fa-59-fe dynamic |
| --- |

　　可以看到带病毒的机器上显示的MAC地址是正确的，而且该机运行速度缓慢，应该为所有流量在二层通过该机进行转发而导致，该机重启后所有电脑都不能上网，只有等arp刷新MAC地址后才正常，一般在2、3分钟左右。

三、如果主机可以进入dos窗口，用arp &ndash;a命令可以看到类似下面的现象：

| C:WINNTsystem32>arp -a            　　Interface: 192.168.100.1 on Interface 0x1000004            　　Internet Address Physical Address Type            　　192.168.100.23 00-50-da-8a-62-2c dynamic            　　192.168.100.24 00-50-da-8a-62-2c dynamic            　　192.168.100.25 00-50-da-8a-62-2c dynamic            　　192.168.100.193 00-50-da-8a-62-2c dynamic            　　192.168.100.200 00-50-da-8a-62-2c dynamic |
| --- |

该病毒不发作的时候，在代理服务器上看到的地址情况如下：

| C:WINNTsystem32>arp -a            　　Interface: 192.168.100.1 on Interface 0x1000004            　　Internet Address Physical Address Type            　　192.168.0.23 00-11-2f-43-81-8b dynamic            　　192.168.100.24 00-50-da-8a-62-2c dynamic            　　192.168.100.25 00-05-5d-ff-a8-87 dynamic            　　192.168.100.193 00-11-2f-b2-9d-17 dynamic            　　192.168.100.200 00-50-ba-fa-59-fe dynamic |
| --- |

　　病毒发作的时候，可以看到所有的ip地址的mac地址被修改为00-50-da-8a-62-2c，正常的时候可以看到MAC地址均不会相同。

解决办法：

一、采用客户机及网关服务器上进行静态ARP绑定的办法来解决。

1． 在所有的客户端机器上做网关服务器的ARP静态绑定。

首先在网关服务器（代理主机）的电脑上查看本机MAC地址

| C:WINNTsystem32>ipconfig /all            　　Ethernet adapter 本地连接 2:            　　Connection-specific DNS Suffix . :            　　Description . . . . . . . . . . . : Intel(R) PRO/100B PCI Adapter (TX)            　　Physical Address. . . . . . . . . : 00-02-ba-0b-04-32            　　Dhcp Enabled. . . . . . . . . . . : No            　　IP Address. . . . . . . . . . . . : 192.168.100.1            　　Subnet Mask . . . . . . . . . . . : 255.255.255.0 |
| --- |

　　然后在客户机器的DOS命令下做ARP的静态绑定

C:WINNTsystem32>arp &ndash;s 192.168.100.1 00-02-ba-0b-04-32

注：如有条件，建议在客户机上做所有其他客户机的IP和MAC地址绑定。

2． 在网关服务器（代理主机）的电脑上做客户机器的ARP静态绑定

首先在所有的客户端机器上查看IP和MAC地址，命令如上。

然后在代理主机上做所有客户端服务器的ARP静态绑定。如：

| C:winntsystem32> arp &ndash;s 192.168.0.23 00-11-2f-43-81-8b            　　C:winntsystem32> arp &ndash;s 192.168.0.24 00-50-da-8a-62-2c            　　C:winntsystem32> arp &ndash;s 192.168.0.25 00-05-5d-ff-a8-87            　　。。。。。。。。。 |
| --- |

　　3． 以上ARP的静态绑定最后做成一个windows自启动文件，让电脑一启动就执行以上操作，保证配置不丢失。

二、有条件的可以在交换机内进行IP地址与MAC地址绑定

三、IP和MAC进行绑定后，更换网卡需要重新绑定，因此建议在客户机安装杀毒软件来解决此类问题。

夜火:记得去年我们班里经常断网,重启交换机之后就能连上一阵子,但是过后又断网,我当时就试试看的装了antiarp,结果真的查到的arp欺骗的机器~,可以说arp病毒对局域网的杀伤力是很大的~~

